<!DOCTYPE HTML>
<html xmlns:yui="http://yuilibrary.com/rdf/1.0/yui.rdf#">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>API: dom   domlib.js </title>

	<link rel="stylesheet" type="text/css" href="assets/reset-fonts-grids-min.css?stamp=1326369229.93" />
	<link rel="stylesheet" type="text/css" href="assets/api.css?stamp=1326369229.93" />

    <script type="text/javascript" src="assets/api-js?stamp=1326369229.93"></script>
    <script type="text/javascript" src="assets/ac-js?stamp=1326369229.93"></script>
</head>

<body id="yahoo-com">

<div id="doc3" class="yui-t2">
	<div id="hd">
        <h1><a href="'https://github.com/ZauberNerd/domlib'" title="domlib">domlib</a></h1>
        <h3>dom&nbsp; <span class="subtitle">0.0.1</span></h3>
        <a href="./index.html" title="domlib">domlib</a> 
            &gt; <a href="./module_dom.html" title="dom">dom</a>
                
                 &gt; domlib.js (source view) 
        <form onsubmit="return false">
            <div id="propertysearch">
                Search: <input autocomplete="off" id="searchinput" />
                <div id="searchresults">
                    &nbsp;
                </div>
            </div>
        </form>
	</div>

	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">
            <form action="#" name="yui-classopts-form" method="get" id="yui-classopts-form">
                <fieldset>
                    <legend>Filters</legend>
                <span class="classopts"><input type="checkbox" name="show_private" id="show_private" /> <label for="show_private">Show Private</label></span>
                <span class="classopts"><input type="checkbox" name="show_protected" id="show_protected" /> <label for="show_protected">Show Protected</label></span>
                <span class="classopts"><input type="checkbox" name="show_deprecated" id="show_deprecated" /> <label for="show_deprecated">Show Deprecated</label></span>
                </fieldset>
            </form>

                    <div id="srcout">
                        <style>
                            #doc3 .classopts { display:none; }
                        </style>
<div class="highlight"><pre><span class="cm">/**</span>
<span class="cm"> * Copyright (c) 2012 Bjoern Brauer</span>
<span class="cm"> * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</span>
<span class="cm"> * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span>
<span class="cm"> */</span>


<span class="cm">/**</span>
<span class="cm"> * Module for Dom Manipulations, Traversing and some small helpers</span>
<span class="cm"> * @module dom</span>
<span class="cm"> * @class dom</span>
<span class="cm"> * @static</span>
<span class="cm"> */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">win</span><span class="p">,</span> <span class="nx">doc</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
    <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">domtools</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="c1">// noop function which is used as selector engine if your browser doesn&#39;t support querySelectorAll and if you didn&#39;t set a selectorEngine using dom.setSelectorEngine.</span>
        <span class="kd">function</span> <span class="nx">selectorEngine</span><span class="p">()</span> <span class="p">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;The CSS Selector Engine isn\&#39;t ready yet!&#39;</span><span class="p">);</span> <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">selectors</span> <span class="o">=</span> <span class="p">{</span>
            <span class="cm">/**</span>
<span class="cm">             * Returns an Element by its ID</span>
<span class="cm">             * @method byId</span>
<span class="cm">             * @param {String} id The ID of the Element you want to reference</span>
<span class="cm">             * @return {Element} If there is an Element with the given ID it will be returned - otherwise the returnvalue is undefined</span>
<span class="cm">             */</span>
            <span class="nx">byId</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span> <span class="p">},</span>
            <span class="cm">/**</span>
<span class="cm">             * Returns Elements by their Name</span>
<span class="cm">             * @method byName</span>
<span class="cm">             * @param {String} name The Name of the Element you want to reference</span>
<span class="cm">             * @return {[NodeList]} Returns a NodeList of Elements which match the given Name</span>
<span class="cm">             */</span>
            <span class="nx">byName</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">getElementsByName</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span> <span class="p">},</span>
            <span class="cm">/**</span>
<span class="cm">             * Returns Elements by their Tagname</span>
<span class="cm">             * @method byTagName</span>
<span class="cm">             * @param {String} tag The Tagname of the Element you want to reference</span>
<span class="cm">             * @param {Element} scope Optional: You could provide a Scope of an Element to search only inside that Scope for Elements</span>
<span class="cm">             * @return {[NodeList]} Returns a NodeList of Elements which match the given Tagname</span>
<span class="cm">             */</span>
            <span class="nx">byTagName</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">tag</span><span class="p">,</span> <span class="nx">scope</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">typeof</span> <span class="nx">scope</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">tag</span><span class="p">)</span> <span class="o">:</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">tag</span><span class="p">);</span> <span class="p">}</span>
        <span class="p">};</span>
        <span class="cm">/**</span>
<span class="cm">         * Returns Elements using a CSS Selector Query</span>
<span class="cm">         * @method query</span>
<span class="cm">         * @param {String} selector Any CSS Selector. For Example: a[href=&quot;#&quot;] or p &gt; div &gt; .foo.bar ~ span</span>
<span class="cm">         * @param {Element} scope Optional: You could provide a Scope of an Element to search only inside that Scope for Elements</span>
<span class="cm">         * @return {[NodeList]} Returns a NodeList of Elements which match the given Selector</span>
<span class="cm">         */</span>
        <span class="nx">selectors</span><span class="p">.</span><span class="nx">query</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">querySelectorAll</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span>
                <span class="kd">function</span> <span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">scope</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">selectorEngine</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">scope</span> <span class="o">||</span> <span class="nx">doc</span><span class="p">);</span> <span class="p">}</span> <span class="o">:</span>
                <span class="kd">function</span> <span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">scope</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">typeof</span> <span class="nx">scope</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">:</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span> <span class="p">};</span>
        <span class="cm">/**</span>
<span class="cm">         * Returns Elements by their className</span>
<span class="cm">         * @method byClass</span>
<span class="cm">         * @param {String} classname The className you want to search for</span>
<span class="cm">         * @param {Element} scope Optional: You could provide a Scope of an Element to search only inside that Scope for Elements</span>
<span class="cm">         * @return {[NodeList]} Returns a NodeList of Elements which have the given className</span>
<span class="cm">         */</span>
        <span class="nx">selectors</span><span class="p">.</span><span class="nx">byClass</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">getElementsByClassName</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span>
                <span class="k">typeof</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">querySelectorAll</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span>
                        <span class="kd">function</span> <span class="p">(</span><span class="nx">classname</span><span class="p">,</span> <span class="nx">scope</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">selectorEngine</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">classname</span><span class="p">,</span> <span class="nx">scope</span> <span class="o">||</span> <span class="nx">doc</span><span class="p">);</span> <span class="p">}</span> <span class="o">:</span>
                        <span class="kd">function</span> <span class="p">(</span><span class="nx">classname</span><span class="p">,</span> <span class="nx">scope</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">typeof</span> <span class="nx">scope</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">classname</span><span class="p">)</span> <span class="o">:</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">classname</span><span class="p">);</span> <span class="p">}</span> <span class="o">:</span>
                        <span class="kd">function</span> <span class="p">(</span><span class="nx">classname</span><span class="p">,</span> <span class="nx">scope</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">typeof</span> <span class="nx">scope</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">classname</span><span class="p">)</span> <span class="o">:</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">classname</span><span class="p">);</span> <span class="p">};</span>

        <span class="cm">/**</span>
<span class="cm">         * If the Browser doesn&#39;t support querySelectorAll add the Method setSelectorEngine to domtools which replaces the noop function selectorEngine with i.e. Sizzle or something else.</span>
<span class="cm">         * This Method will only be avaialable if the Browser doesn&#39;t support querySelectorAll, so you have to test if this method exists and if it&#39;s true you must call it and pass a CSS Selector Engine.</span>
<span class="cm">         * Otherwise domtools.query and domtools.byClass will throw an Error everytime you call them.</span>
<span class="cm">         * The easiest way: Create an init function for your application and check if domtools.setSelectorEngine exists, if not you could call your init function, otherwise load Sizzle and call then your init function.</span>
<span class="cm">         * @method setSelectorEngine</span>
<span class="cm">         * @param {Function} engine The Selector Engine you want to use</span>
<span class="cm">         */</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">querySelectorAll</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">selectors</span><span class="p">.</span><span class="nx">setSelectorEngine</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">engine</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">selectorEngine</span> <span class="o">=</span> <span class="nx">engine</span><span class="p">;</span>
            <span class="p">};</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">selectors</span><span class="p">;</span>
    <span class="p">}());</span>

    <span class="cm">/**</span>
<span class="cm">     * A Wrapper Function for getting and setting custom data-* Attributes on Dom Elements</span>
<span class="cm">     * @param {Element} el The Element on which you want operate</span>
<span class="cm">     * @param {String} key Optional: If you don&#39;t provide a Key and optVal you will return an Object containing all data-* Properties (camelCased). Otherwise you could provide a Key to get or set a specific Attribute.</span>
<span class="cm">     * @param {String} optVal Optional: If you don&#39;t specify a value, the current data-* Value for the given Key is returned. Otherwise you can set the Value</span>
<span class="cm">     * @return {Mixed} Depends on how many Parameters you specify you get either an Object containing all data-* Values or the specific Value you&#39;ve get/set.</span>
<span class="cm">     */</span>
    <span class="nx">domtools</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">fn</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;dataset&#39;</span> <span class="k">in</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)))</span> <span class="p">{</span>
            <span class="nx">fn</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="cm">/**</span>
<span class="cm">                 * A Helper Function for camelCasing Strings which have hyphens in it (for example: &#39;foo-bar-baz&#39; would become &#39;fooBarBaz&#39;).</span>
<span class="cm">                 * @method camelCase</span>
<span class="cm">                 * @private</span>
<span class="cm">                 * @param {String} string The String you want to camelcase</span>
<span class="cm">                 * @return {String} A String without hypens where every Character directly after a hyphen is camelcased.</span>
<span class="cm">                 */</span>
                <span class="kd">function</span> <span class="nx">camelCase</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nx">string</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-([a-z])/ig</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">all</span><span class="p">,</span> <span class="nx">letter</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">letter</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span> <span class="p">});</span>
                <span class="p">}</span>
                <span class="cm">/**</span>
<span class="cm">                 * A Helper Function for hyphenating Strings which are camelCased (for example: &#39;fooBarBaz&#39; would become &#39;foo-bar-baz&#39;).</span>
<span class="cm">                 * @method hyphenate</span>
<span class="cm">                 * @private</span>
<span class="cm">                 * @param {String} string The String you want to hyphenate</span>
<span class="cm">                 * @return {String} A lowercased String with hyphens before every Character which was before uppercased.</span>
<span class="cm">                 */</span>
                <span class="kd">function</span> <span class="nx">hyphenate</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nx">string</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([A-Z])/g</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">all</span><span class="p">,</span> <span class="nx">letter</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nx">letter</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span> <span class="p">});</span>
                <span class="p">}</span>
                <span class="cm">/**</span>
<span class="cm">                 * A Helper Function for getting the Value of an data-* Attribute</span>
<span class="cm">                 * @method getData</span>
<span class="cm">                 * @private</span>
<span class="cm">                 * @param {Element} el The Dom Element on which you operate</span>
<span class="cm">                 * @param {String} string The Key of the data-* Attribute you want to read</span>
<span class="cm">                 * @return {String} The Value from the custom data-* Attribute</span>
<span class="cm">                 */</span>
                <span class="kd">function</span> <span class="nx">getData</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nx">el</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;data-&#39;</span> <span class="o">+</span> <span class="nx">hyphenate</span><span class="p">(</span><span class="nx">key</span><span class="p">));</span>
                <span class="p">}</span>
                <span class="cm">/**</span>
<span class="cm">                 * A Helper Function for setting the Value of an data-* Attribute</span>
<span class="cm">                 * @method setData</span>
<span class="cm">                 * @private</span>
<span class="cm">                 * @param {Element} el The Dom Element on which you operate</span>
<span class="cm">                 * @param {String} string The Key of the data-* Attribute you want to set</span>
<span class="cm">                 * @param {String} val The Value you want to write in the data-* Attribute</span>
<span class="cm">                 * @return {String} The Value from the custom data-* Attribute</span>
<span class="cm">                 */</span>
                <span class="kd">function</span> <span class="nx">setData</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">el</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;data-&#39;</span> <span class="o">+</span> <span class="nx">hyphenate</span><span class="p">(</span><span class="nx">key</span><span class="p">),</span> <span class="nx">val</span><span class="p">);</span>
                    <span class="k">return</span> <span class="nx">getData</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">key</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="cm">/**</span>
<span class="cm">                 * A Helper Function for setting the Value of an data-* Attribute</span>
<span class="cm">                 * @method getSetData</span>
<span class="cm">                 * @private</span>
<span class="cm">                 * @param {Element} el The Element on which you want operate</span>
<span class="cm">                 * @param {String} key Optional: If you don&#39;t provide a Key and optVal you will return an Object containing all data-* Properties (camelCased). Otherwise you could provide a Key to get or set a specific Attribute.</span>
<span class="cm">                 * @param {String} optVal Optional: If you don&#39;t specify a value, the current data-* Value for the given Key is returned. Otherwise you can set the Value</span>
<span class="cm">                 * @return {Mixed} Depends on how many Parameters you specify you get either an Object containing all data-* Values or the specific Value you&#39;ve get/set.</span>
<span class="cm">                 */</span>
                <span class="kd">function</span> <span class="nx">getSetData</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">optVal</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">key</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="k">typeof</span> <span class="nx">optVal</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span> <span class="nx">getData</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="o">:</span> <span class="nx">setData</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">optVal</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">attrs</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attributes</span><span class="p">,</span>
                            <span class="nx">len</span> <span class="o">=</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
                            <span class="nx">data</span> <span class="o">=</span> <span class="p">{};</span>
                        <span class="k">while</span> <span class="p">(</span><span class="nx">len</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">len</span><span class="p">].</span><span class="nx">name</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;data-&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">data</span><span class="p">[</span><span class="nx">camelCase</span><span class="p">(</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">len</span><span class="p">].</span><span class="nx">name</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">5</span><span class="p">))]</span> <span class="o">=</span> <span class="nx">attrs</span><span class="p">[</span><span class="nx">len</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="nx">getSetData</span><span class="p">;</span>
            <span class="p">}());</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">fn</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">optVal</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">typeof</span> <span class="nx">optVal</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span> <span class="k">typeof</span> <span class="nx">key</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">?</span> <span class="nx">el</span><span class="p">.</span><span class="nx">dataset</span> <span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">dataset</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">dataset</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">optVal</span><span class="p">;</span>
            <span class="p">};</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">fn</span><span class="p">;</span>
    <span class="p">}());</span>

    <span class="cm">/**</span>
<span class="cm">     * Element.classList Polyfill / Submodule</span>
<span class="cm">     * @module dom</span>
<span class="cm">     * @namespace dom</span>
<span class="cm">     * @submodule classList</span>
<span class="cm">     * @class classList</span>
<span class="cm">     * @method classList</span>
<span class="cm">     * @constructor</span>
<span class="cm">     * @static</span>
<span class="cm">     * @param {Element} el</span>
<span class="cm">     */</span>
    <span class="nx">domtools</span><span class="p">.</span><span class="nx">classList</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">classListPolyfill</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="nx">ClassList</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;classList&#39;</span> <span class="k">in</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)))</span> <span class="p">{</span>
            <span class="cm">/**</span>
<span class="cm">             * Method that returns a Constructor Function for creating a classList Object</span>
<span class="cm">             * @method getConstructor</span>
<span class="cm">             * @return {Function} Returns a Constructor Function which can then extended by adding Methods to its Prototype</span>
<span class="cm">             * @private</span>
<span class="cm">             */</span>
            <span class="nx">classListPolyfill</span><span class="p">.</span><span class="nx">getConstructor</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">Constr</span><span class="p">,</span>
                    <span class="nx">test</span><span class="p">;</span>
                <span class="nx">Constr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getRegularConstructor</span><span class="p">();</span>
                <span class="c1">// Create a new ClassList Object, pass a small Object containing a className property and test if the length property of the ClassList Object is correct.</span>
                <span class="c1">// If not, we are on an IE7 or below who can&#39;t subclass the Array Object so we need a workaround.</span>
                <span class="nx">test</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Constr</span><span class="p">({</span> <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;foo bar baz&#39;</span> <span class="p">});</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">test</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">lteie7</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                    <span class="k">return</span> <span class="nx">Constr</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">lteie7</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">getIE7Constructor</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">};</span>
            <span class="cm">/**</span>
<span class="cm">             * Returns a Constructor Function whichs prototype is set to Array.prototype</span>
<span class="cm">             * @method getRegularConstructor</span>
<span class="cm">             * @return {Function} Returns a Constructor Function which can then extended by adding Methods to its Prototype</span>
<span class="cm">             * @private</span>
<span class="cm">             */</span>
            <span class="nx">classListPolyfill</span><span class="p">.</span><span class="nx">getRegularConstructor</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="cm">/**</span>
<span class="cm">                 * Constructor Function for the classList Polyfill</span>
<span class="cm">                 * @method ClassList</span>
<span class="cm">                 * @param {Element} el The Element from which you want to get / set / toggle the classNames</span>
<span class="cm">                 * @private</span>
<span class="cm">                 */</span>
                <span class="nx">ClassList</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
                    <span class="cm">/**</span>
<span class="cm">                     * Internal Array of Classes from the className property of the Element</span>
<span class="cm">                     * @private</span>
<span class="cm">                     * @type property</span>
<span class="cm">                     */</span>
                    <span class="kd">var</span> <span class="nx">classes</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
                    <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">(</span><span class="nx">classes</span> <span class="o">?</span> <span class="nx">classes</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">)</span> <span class="o">:</span> <span class="p">[]));</span>
                    <span class="cm">/**</span>
<span class="cm">                     * Method for updating the className Property of the HTML Element</span>
<span class="cm">                     * @protected</span>
<span class="cm">                     */</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_updateClassName</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="nx">el</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span> <span class="p">};</span>
                <span class="p">};</span>
                <span class="nx">ClassList</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
                <span class="k">return</span> <span class="nx">ClassList</span><span class="p">;</span>
            <span class="p">};</span>
            <span class="cm">/**</span>
<span class="cm">             * Returns a Constructor Function which basically is an Array Object borrowed from an iframe. IE 7 and below can&#39;t handle a Constructor Function whichs prototype is set to Array.prototype,</span>
<span class="cm">             * so we create an iframe and pass the Array Object from the iframe to its parent Window. We then use this regular Array Object and extending it&#39;s prototype.</span>
<span class="cm">             * @method getIE7Constructor</span>
<span class="cm">             * @return {Function} Returns a Constructor Function which can then extended by adding Methods to its Prototype</span>
<span class="cm">             * @private</span>
<span class="cm">             */</span>
            <span class="nx">classListPolyfill</span><span class="p">.</span><span class="nx">getIE7Constructor</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;iframe&#39;</span><span class="p">);</span>
                <span class="nx">iframe</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
                <span class="nx">doc</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">iframe</span><span class="p">);</span>
                <span class="nx">iframe</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s2">&quot;&lt;script&gt;parent.LTEie7ClassListPolyFill = Array;&lt;/script&gt;&quot;</span><span class="p">);</span>
                <span class="c1">// Because the iframe doesn&#39;t have the Ecmascript5 Polyfills we&#39;ve included we need to set the prototype manually</span>
                <span class="nx">LTEie7ClassListPolyFill</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">;</span>
                <span class="c1">// We only extending the Array Object, so we need to create the own Methods and Properties which regulary sits in the Constructor function as prototypes too.</span>
                <span class="nx">LTEie7ClassListPolyFill</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_dom_int_classes</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_dom_int_classes</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">_dom_int_classes</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/</span><span class="p">)</span> <span class="o">:</span> <span class="p">[]));</span>
                <span class="p">};</span>
                <span class="nx">LTEie7ClassListPolyFill</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_updateClassName</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_dom_int_classes</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
                <span class="p">};</span>
                <span class="k">return</span> <span class="nx">LTEie7ClassListPolyFill</span><span class="p">;</span>
            <span class="p">};</span>
            <span class="nx">ClassList</span> <span class="o">=</span> <span class="nx">classListPolyfill</span><span class="p">.</span><span class="nx">getConstructor</span><span class="p">();</span>
            <span class="cm">/**</span>
<span class="cm">             * Adds a class to the className of the Element</span>
<span class="cm">             * @method add</span>
<span class="cm">             * @param {String} token Name of the class which should be added</span>
<span class="cm">             */</span>
            <span class="nx">ClassList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">token</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_updateClassName</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">};</span>
            <span class="cm">/**</span>
<span class="cm">             * Removes a class from the className of the Element</span>
<span class="cm">             * @method remove</span>
<span class="cm">             * @param {String} token Name of the class which should be removed</span>
<span class="cm">             */</span>
            <span class="nx">ClassList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">token</span><span class="p">.</span><span class="nx">trim</span><span class="p">());</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_updateClassName</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">};</span>
            <span class="cm">/**</span>
<span class="cm">             * Toggles a class on the given Element on and off</span>
<span class="cm">             * @method toggle</span>
<span class="cm">             * @param {String} token Name of the class which you want to toggle</span>
<span class="cm">             * @return {Boolean} Returns true if the class was added or false when the class was removed</span>
<span class="cm">             */</span>
            <span class="nx">ClassList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toggle</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">ret</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">token</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
                    <span class="nx">ret</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
                    <span class="nx">ret</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_updateClassName</span><span class="p">();</span>
                <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
            <span class="p">};</span>
            <span class="cm">/**</span>
<span class="cm">             * Checks if the given class already exists on the Element</span>
<span class="cm">             * @method contains</span>
<span class="cm">             * @param {String} token Name of the class to be checked</span>
<span class="cm">             * @return {Boolean} Returns true if the Element already has the given Class</span>
<span class="cm">             */</span>
            <span class="nx">ClassList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">contains</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">token</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="p">};</span>
            <span class="cm">/**</span>
<span class="cm">             * Creates a String of the classes contained in the classList separated by whitespaces to write them into the className property of an Element</span>
<span class="cm">             * @method toString</span>
<span class="cm">             * @return {String} String of the classes contained in the classList separated by whitespaces</span>
<span class="cm">             */</span>
            <span class="nx">ClassList</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span> <span class="p">};</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">classListPolyfill</span><span class="p">.</span><span class="nx">lteie7</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">cl</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ClassList</span><span class="p">();</span> <span class="nx">cl</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span> <span class="k">return</span> <span class="nx">cl</span><span class="p">;</span> <span class="p">};</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="k">new</span> <span class="nx">ClassList</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span> <span class="p">};</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">el</span><span class="p">.</span><span class="nx">classList</span><span class="p">;</span> <span class="p">};</span>
        <span class="p">}</span>
    <span class="p">}());</span>

    <span class="cm">/**</span>
<span class="cm">     * Submodule for Dom Event handling</span>
<span class="cm">     * @module dom</span>
<span class="cm">     * @namespace dom</span>
<span class="cm">     * @submodule event</span>
<span class="cm">     * @class event</span>
<span class="cm">     */</span>
    <span class="nx">domtools</span><span class="p">.</span><span class="nx">event</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">eventhandler</span> <span class="o">=</span> <span class="p">{</span>
            <span class="cm">/**</span>
<span class="cm">             * Shorthand Function for event.preventDefault and event.stopPropagation.</span>
<span class="cm">             * This Method replaces itself on its first invocation with a Method specialized for the current Browser.</span>
<span class="cm">             * @param {Event} ev The Eventobject</span>
<span class="cm">             * @param {Boolean} stopPropagation Optional: Pass true, if you also want to stop the Event from bubbling up</span>
<span class="cm">             */</span>
            <span class="nx">preventDefault</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">,</span> <span class="nx">stopPropagation</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">fn</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">ev</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">fn</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">stopPropagation</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
                        <span class="nx">stopPropagation</span> <span class="o">&amp;&amp;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
                    <span class="p">};</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">win</span><span class="p">.</span><span class="nx">event</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">fn</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">stopPropagation</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">win</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                        <span class="nx">stopPropagation</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">win</span><span class="p">.</span><span class="nx">event</span><span class="p">.</span><span class="nx">cancelBubble</span> <span class="o">=</span> <span class="kc">true</span><span class="p">);</span>
                    <span class="p">};</span>
                <span class="p">}</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">preventDefault</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">;</span>
                <span class="k">return</span> <span class="nx">fn</span><span class="p">(</span><span class="nx">ev</span> <span class="o">||</span> <span class="nx">win</span><span class="p">.</span><span class="nx">event</span><span class="p">,</span> <span class="nx">stopPropagation</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">win</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>
            <span class="cm">/**</span>
<span class="cm">             * Method for registering Callback Functions to Dom Events</span>
<span class="cm">             * @param {Element} el The Element on which the listener should be bound</span>
<span class="cm">             * @param {String} event The Eventtype you want listen for</span>
<span class="cm">             * @param {Function} listener The Listener Callback which will be exected when the Event occurs</span>
<span class="cm">             */</span>
            <span class="nx">eventhandler</span><span class="p">.</span><span class="nx">connect</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">listener</span><span class="p">)</span> <span class="p">{</span> <span class="nx">el</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">listener</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span> <span class="p">};</span>
            <span class="cm">/**</span>
<span class="cm">             * Method for deregistering Callback Functions to Dom Events</span>
<span class="cm">             * @param {Element} el The Element on which the listener is currently bound</span>
<span class="cm">             * @param {String} event The Eventtype the listener is registered for</span>
<span class="cm">             * @param {Function} listener The Listener Callback which was registred for this event</span>
<span class="cm">             */</span>
            <span class="nx">eventhandler</span><span class="p">.</span><span class="nx">disconnect</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">listener</span><span class="p">)</span> <span class="p">{</span> <span class="nx">el</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">listener</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span> <span class="p">};</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">win</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">eventhandler</span><span class="p">.</span><span class="nx">connect</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">listener</span><span class="p">)</span> <span class="p">{</span> <span class="nx">el</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">listener</span><span class="p">);</span> <span class="p">};</span>
            <span class="nx">eventhandler</span><span class="p">.</span><span class="nx">disconnect</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">listener</span><span class="p">)</span> <span class="p">{</span> <span class="nx">el</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">detachEvent</span><span class="p">(</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">listener</span><span class="p">);</span> <span class="p">};</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">eventhandler</span><span class="p">.</span><span class="nx">connect</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">listener</span><span class="p">)</span> <span class="p">{</span> <span class="nx">el</span><span class="p">[</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">]</span> <span class="o">=</span> <span class="nx">listener</span><span class="p">;</span> <span class="p">};</span>
            <span class="nx">eventhandler</span><span class="p">.</span><span class="nx">disconnect</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">event</span><span class="p">,</span> <span class="nx">listener</span><span class="p">)</span> <span class="p">{</span> <span class="k">delete</span> <span class="nx">el</span><span class="p">[</span><span class="s1">&#39;on&#39;</span> <span class="o">+</span> <span class="nx">event</span><span class="p">];</span> <span class="p">};</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">eventhandler</span><span class="p">;</span>
    <span class="p">}());</span>

    <span class="cm">/**</span>
<span class="cm">     * Submodule for some helper functions</span>
<span class="cm">     * @module dom</span>
<span class="cm">     * @namespace dom</span>
<span class="cm">     * @submodule helper</span>
<span class="cm">     * @class helper</span>
<span class="cm">     */</span>
    <span class="nx">domtools</span><span class="p">.</span><span class="nx">helper</span> <span class="o">=</span> <span class="p">{</span>
        <span class="cm">/**</span>
<span class="cm">         * Method that takes a function and returns a function which can only be executed once</span>
<span class="cm">         * @method once</span>
<span class="cm">         * @param {Function} fn The Function you want to &#39;protect&#39; for executing more than once</span>
<span class="cm">         * @return {Function} Returns a Function which can only be executed once (deletes the reference to the original function and fails silently)</span>
<span class="cm">         */</span>
        <span class="nx">once</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">callback</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">;</span>
                <span class="nx">fn</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="k">return</span> <span class="nx">callback</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">();</span>
            <span class="p">};</span>
        <span class="p">},</span>
        <span class="cm">/**</span>
<span class="cm">         * Method for loading Javascript Files asynchronously</span>
<span class="cm">         * @method loadScript</span>
<span class="cm">         * @param {String} url the Url of the Script that should be loaded</span>
<span class="cm">         * @param {String} id A unique Name to prevent loading the same file twice (this ID will be used as a Dom ID)</span>
<span class="cm">         * @param {Function} callback Optional: A Callback Function which should be executed when the Script is fully loaded (the callback gets also executed if the file is already loaded)</span>
<span class="cm">         * @return {Boolean} Returns false if the Script is already loaded</span>
<span class="cm">         */</span>
        <span class="nx">loadScript</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">))</span> <span class="p">{</span>
                <span class="c1">// early exit if the script is already loaded</span>
                <span class="nx">callback</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">();</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">url</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;You must provide an unique id and an url from where the script should be loaded!&#39;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">js</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">),</span>
                <span class="nx">callbackonce</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="nx">callback</span><span class="p">),</span>
                <span class="nx">fjs</span> <span class="o">=</span> <span class="nx">doc</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="nx">js</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span><span class="p">;</span>
            <span class="nx">js</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
            <span class="nx">js</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="c1">// standard conform browsers fire onload event. IE fires onreadystatechange events and sometimes only &#39;complete&#39; or &#39;loaded&#39;</span>
            <span class="nx">js</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nx">js</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="k">this</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="s1">&#39;complete&#39;</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="s1">&#39;loaded&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">callbackonce</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">};</span>
            <span class="nx">fjs</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">js</span><span class="p">,</span> <span class="nx">fjs</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="cm">/**</span>
<span class="cm">     * Submodule for making Ajax-Calls</span>
<span class="cm">     * @module dom</span>
<span class="cm">     * @namespace dom</span>
<span class="cm">     * @submodule xhr</span>
<span class="cm">     * @class xhr</span>
<span class="cm">     */</span>
    <span class="nx">domtools</span><span class="p">.</span><span class="nx">xhr</span> <span class="o">=</span> <span class="p">{</span>
        <span class="cm">/**</span>
<span class="cm">         * Method for making Ajax Requests</span>
<span class="cm">         * @method request</span>
<span class="cm">         * @param {String} method The Method that should be used for the request (&#39;get&#39; or &#39;post&#39;, will be automatically transformed to uppercase).</span>
<span class="cm">         * @param {String} url The Url to which the Ajax call should be made</span>
<span class="cm">         * @param {Mixed} data Optional: The data you want to send</span>
<span class="cm">         * @param {Function} success The Success Callback will be called if the Request was made Successful (readyState === 4, httpStatus === 200).</span>
<span class="cm">         * @param {Function} error The Error Callback will be called if the Server responded with a different StatusCode than 200</span>
<span class="cm">         * @return {Object} Returns the XMLHttpRequest Object for that Request.</span>
<span class="cm">         */</span>
        <span class="nx">request</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">success</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">headers</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;X-Requested-With&#39;</span><span class="p">,</span> <span class="s1">&#39;XMLHttpRequest&#39;</span><span class="p">]],</span>
                <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">win</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">();</span>
            <span class="c1">// adjust parameters</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">data</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">error</span> <span class="o">=</span> <span class="nx">success</span><span class="p">;</span>
                <span class="nx">success</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
                <span class="nx">data</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">method</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">url</span> <span class="o">=</span> <span class="nx">method</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>
                <span class="nx">data</span> <span class="o">=</span> <span class="nx">method</span><span class="p">.</span><span class="nx">data</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
                <span class="nx">success</span> <span class="o">=</span> <span class="nx">method</span><span class="p">.</span><span class="nx">success</span><span class="p">;</span>
                <span class="nx">error</span> <span class="o">=</span> <span class="nx">method</span><span class="p">.</span><span class="nx">error</span><span class="p">;</span>
                <span class="nx">headers</span> <span class="o">=</span> <span class="nx">headers</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">method</span><span class="p">.</span><span class="nx">headers</span> <span class="o">||</span> <span class="p">[]);</span>
                <span class="nx">method</span> <span class="o">=</span> <span class="nx">method</span><span class="p">.</span><span class="nx">method</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">method</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">(),</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="nx">headers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">header</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="nx">header</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">header</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
            <span class="p">});</span>
            <span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">responseText</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">responseText</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;application/json&#39;</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">responseText</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">responseText</span><span class="p">);</span>
                        <span class="p">}</span>
                        <span class="nx">success</span> <span class="o">&amp;&amp;</span> <span class="nx">success</span><span class="p">(</span><span class="nx">responseText</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">error</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">status</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">};</span>
            <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">xhr</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="cm">/**</span>
<span class="cm">         * Method / Shortcut for making Ajax Get Requestes</span>
<span class="cm">         * @method get</span>
<span class="cm">         * @param {String} url The Url to which the Ajax call should be made</span>
<span class="cm">         * @param {Function} success The Success Callback will be called if the Request was made Successful (readyState === 4, httpStatus === 200).</span>
<span class="cm">         * @param {Function} error The Error Callback will be called if the Server responded with a different StatusCode than 200</span>
<span class="cm">         * @return {Object} Returns the XMLHttpRequest Object for that Request.</span>
<span class="cm">         */</span>
        <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="cm">/**</span>
<span class="cm">         * Method / Shortcut for making Ajax Post Requestes</span>
<span class="cm">         * @method post</span>
<span class="cm">         * @param {String} url The Url to which the Ajax call should be made</span>
<span class="cm">         * @param {Mixed} data Optional: The data you want to send</span>
<span class="cm">         * @param {Function} success The Success Callback will be called if the Request was made Successful (readyState === 4, httpStatus === 200).</span>
<span class="cm">         * @param {Function} error The Error Callback will be called if the Server responded with a different StatusCode than 200</span>
<span class="cm">         * @return {Object} Returns the XMLHttpRequest Object for that Request.</span>
<span class="cm">         */</span>
        <span class="nx">post</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">headers</span><span class="p">;</span>
            <span class="c1">// if data is an instance of this.FormData and data._boundary is defined it&#39;s our polyfill and we need to set the required http headers</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">data</span> <span class="k">instanceof</span> <span class="k">this</span><span class="p">.</span><span class="nx">FormData</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">data</span><span class="p">.</span><span class="nx">_boundary</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">headers</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">_contentType</span><span class="p">]];</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
                <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
                <span class="nx">url</span><span class="o">:</span> <span class="nx">url</span><span class="p">,</span>
                <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
                <span class="nx">success</span><span class="o">:</span> <span class="nx">callback</span><span class="p">,</span>
                <span class="nx">error</span><span class="o">:</span> <span class="nx">error</span><span class="p">,</span>
                <span class="nx">headers</span><span class="o">:</span> <span class="nx">headers</span>
            <span class="p">});</span>
        <span class="p">},</span>
        <span class="cm">/**</span>
<span class="cm">         * Small FormData polyfill (doesn&#39;t work with input type=&quot;file&quot; / binary data)</span>
<span class="cm">         * @class FormData</span>
<span class="cm">         * @module dom</span>
<span class="cm">         * @namespace dom</span>
<span class="cm">         * @submodule FormData</span>
<span class="cm">         * @constructor</span>
<span class="cm">         * @param {Element} form Optional: You could pass a Form-Element to the Constructor to create an FormData Object from it</span>
<span class="cm">         */</span>
        <span class="nx">FormData</span><span class="o">:</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">_FormData</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">win</span><span class="p">.</span><span class="nx">FormData</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">_FormData</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">form</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">inputs</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">concat</span><span class="p">(</span>
                        <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">domtools</span><span class="p">.</span><span class="nx">byTagName</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="nx">form</span><span class="p">)),</span>
                        <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">domtools</span><span class="p">.</span><span class="nx">byTagName</span><span class="p">(</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="nx">form</span><span class="p">)),</span>
                        <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">domtools</span><span class="p">.</span><span class="nx">byTagName</span><span class="p">(</span><span class="s1">&#39;textarea&#39;</span><span class="p">,</span> <span class="nx">form</span><span class="p">))</span>
                    <span class="p">);</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_fields</span> <span class="o">=</span> <span class="p">[];</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_boundary</span> <span class="o">=</span> <span class="s1">&#39;----FormDataBoundary&#39;</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">10</span><span class="p">;</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_contentType</span> <span class="o">=</span> <span class="s1">&#39;multipart/form-data; boundary=&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_boundary</span><span class="p">;</span>
                    <span class="nx">inputs</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">val</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">field</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;checkbox&#39;</span> <span class="o">||</span> <span class="nx">field</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;radio&#39;</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">field</span><span class="p">.</span><span class="nx">checked</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">val</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">value</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
                            <span class="p">}</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">field</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s1">&#39;SELECT&#39;</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">field</span><span class="p">.</span><span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">val</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="nx">val</span> <span class="o">=</span> <span class="nx">field</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">val</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">this</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">field</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">val</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
                <span class="p">};</span>
                <span class="cm">/**</span>
<span class="cm">                 * Method for adding data to the FormData Element</span>
<span class="cm">                 * @param {String} key The Key that should be used</span>
<span class="cm">                 * @param {Mixed} val The Value</span>
<span class="cm">                 */</span>
                <span class="nx">_FormData</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">append</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">]);</span>
                <span class="p">};</span>
                <span class="cm">/**</span>
<span class="cm">                 * Creating the multipart/form-data String</span>
<span class="cm">                 * @return {String} All Fields concatenated</span>
<span class="cm">                 */</span>
                <span class="nx">_FormData</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">body</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">_fields</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">field</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">body</span> <span class="o">+=</span> <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_boundary</span> <span class="o">+</span> <span class="s1">&#39;\r\n&#39;</span><span class="p">;</span>
                        <span class="nx">body</span> <span class="o">+=</span> <span class="s1">&#39;Content-Disposition: form-data; name=&quot;&#39;</span> <span class="o">+</span> <span class="nx">field</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&quot;;\r\n\r\n&#39;</span><span class="p">;</span>
                        <span class="nx">body</span> <span class="o">+=</span> <span class="nx">field</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;\r\n&#39;</span><span class="p">;</span>
                    <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
                    <span class="nx">body</span> <span class="o">+=</span> <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">_boundary</span> <span class="o">+</span> <span class="s1">&#39;--&#39;</span><span class="p">;</span>
                    <span class="k">return</span> <span class="nx">body</span><span class="p">;</span>
                <span class="p">};</span>
                <span class="k">return</span> <span class="nx">_FormData</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">win</span><span class="p">.</span><span class="nx">FormData</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}())</span>
    <span class="p">};</span>
    <span class="nx">win</span><span class="p">.</span><span class="nx">dom</span> <span class="o">=</span> <span class="nx">domtools</span><span class="p">;</span>
<span class="p">}(</span><span class="nb">window</span><span class="p">,</span> <span class="nb">document</span><span class="p">));</span>
</pre></div>
                    </div>
			</div>
		</div>
		<div class="yui-b">
            <div class="nav">

                    <div id="moduleList" class="module">
                        <h4>Modules</h4>
                        <ul class="content">
                                <li class="selected"><a href="module_dom.html" title="dom">dom</a></li>
                        </ul>
                    </div>

                    <div id="classList" class="module">
                        <h4>Classes</h4>
                        <ul class="content">
                                <li class=""><a href="dom.html" title="dom">dom</a></li>
                                <li class=""><a href="dom.classList.html" title="dom.classList">dom.classList</a></li>
                                <li class=""><a href="dom.event.html" title="dom.event">dom.event</a></li>
                                <li class=""><a href="dom.FormData.html" title="dom.FormData">dom.FormData</a></li>
                                <li class=""><a href="dom.helper.html" title="dom.helper">dom.helper</a></li>
                                <li class=""><a href="dom.xhr.html" title="dom.xhr">dom.xhr</a></li>
                        </ul>
                    </div>

                    <div id="fileList" class="module">
                        <h4>Files</h4>
                        <ul class="content">        
                                <li class="selected"><a href="domlib.js.html" title="domlib.js">domlib.js</a></li>
                        </ul>
                    </div>





            </div>
		</div>
	</div>
	<div id="ft">
        <hr />
        Copyright &copy; 2012 Bjrn Brauer
	</div>
</div>
<script type="text/javascript">
    ALL_YUI_PROPS = [{"url": "dom.classList.html#method_add", "access": "", "host": "dom.classList", "type": "method", "name": "add"}, {"url": "dom.FormData.html#method_append", "access": "", "host": "dom.FormData", "type": "method", "name": "append"}, {"url": "dom.html#method_byClass", "access": "", "host": "dom", "type": "method", "name": "byClass"}, {"url": "dom.html#method_byId", "access": "", "host": "dom", "type": "method", "name": "byId"}, {"url": "dom.html#method_byName", "access": "", "host": "dom", "type": "method", "name": "byName"}, {"url": "dom.html#method_byTagName", "access": "", "host": "dom", "type": "method", "name": "byTagName"}, {"url": "dom.html#method_camelCase", "access": "private", "host": "dom", "type": "method", "name": "camelCase"}, {"url": "dom.classList.html#property_classes", "access": "private", "host": "dom.classList", "type": "property", "name": "classes"}, {"url": "dom.classList.html#method_ClassList", "access": "private", "host": "dom.classList", "type": "method", "name": "ClassList"}, {"url": "dom.event.html#method_connect", "access": "", "host": "dom.event", "type": "method", "name": "connect"}, {"url": "dom.classList.html#method_contains", "access": "", "host": "dom.classList", "type": "method", "name": "contains"}, {"url": "dom.html#method_data", "access": "", "host": "dom", "type": "method", "name": "data"}, {"url": "dom.event.html#method_disconnect", "access": "", "host": "dom.event", "type": "method", "name": "disconnect"}, {"url": "dom.xhr.html#method_get", "access": "", "host": "dom.xhr", "type": "method", "name": "get"}, {"url": "dom.classList.html#method_getConstructor", "access": "private", "host": "dom.classList", "type": "method", "name": "getConstructor"}, {"url": "dom.html#method_getData", "access": "private", "host": "dom", "type": "method", "name": "getData"}, {"url": "dom.classList.html#method_getIE7Constructor", "access": "private", "host": "dom.classList", "type": "method", "name": "getIE7Constructor"}, {"url": "dom.classList.html#method_getRegularConstructor", "access": "private", "host": "dom.classList", "type": "method", "name": "getRegularConstructor"}, {"url": "dom.html#method_getSetData", "access": "private", "host": "dom", "type": "method", "name": "getSetData"}, {"url": "dom.html#method_hyphenate", "access": "private", "host": "dom", "type": "method", "name": "hyphenate"}, {"url": "dom.helper.html#method_loadScript", "access": "", "host": "dom.helper", "type": "method", "name": "loadScript"}, {"url": "dom.helper.html#method_once", "access": "", "host": "dom.helper", "type": "method", "name": "once"}, {"url": "dom.xhr.html#method_post", "access": "", "host": "dom.xhr", "type": "method", "name": "post"}, {"url": "dom.event.html#method_preventDefault", "access": "", "host": "dom.event", "type": "method", "name": "preventDefault"}, {"url": "dom.html#method_query", "access": "", "host": "dom", "type": "method", "name": "query"}, {"url": "dom.classList.html#method_remove", "access": "", "host": "dom.classList", "type": "method", "name": "remove"}, {"url": "dom.xhr.html#method_request", "access": "", "host": "dom.xhr", "type": "method", "name": "request"}, {"url": "dom.html#method_setData", "access": "private", "host": "dom", "type": "method", "name": "setData"}, {"url": "dom.html#method_setSelectorEngine", "access": "", "host": "dom", "type": "method", "name": "setSelectorEngine"}, {"url": "dom.classList.html#method_toggle", "access": "", "host": "dom.classList", "type": "method", "name": "toggle"}, {"url": "dom.classList.html#method_toString", "access": "", "host": "dom.classList", "type": "method", "name": "toString"}, {"url": "dom.FormData.html#method_toString", "access": "", "host": "dom.FormData", "type": "method", "name": "toString"}, {"url": "dom.classList.html#method__updateClassName", "access": "protected", "host": "dom.classList", "type": "method", "name": "_updateClassName"}];
</script>
</body>
</html>
